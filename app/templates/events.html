{% extends "layout.html" %}
{% block content %}
<h2>{{ _('upcoming events') }}</h2>

{% if events %}
  <div class="event-grid">
    {% for event in events %}
      <div class="event-card">
        <h3>{{ event.title }}</h3>
        <p class="date">ğŸ“… {{ event.date[:10] }} {{ event.date[11:16] }}</p>
        <p>{{ event.description[:100] }}...</p>

        <a class="btn" href="{{ url_for('main.event_detail', id=event.id) }}">{{ _('view details') }}</a>

        {% if current_user.is_authenticated and current_user.id == event.created_by %}
          <div class="card-controls">
            <a href="{{ url_for('main.edit_event', id=event.id) }}">{{ _('Edit') }}</a> |
            <form action="{{ url_for('main.delete_event', id=event.id) }}" method="POST" style="display:inline;">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <button type="submit" onclick="return confirm('Delete this event?')">{{ _('Delete') }}</button>
            </form>
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>{{ _('event_not_found') }}</p>
{% endif %}
<br>
{% if current_user.is_authenticated and current_user.role == 'organizer' %}
  <a class="btn" href="{{ url_for('main.create_event') }}">{{ _('Create New Event') }}</a>
{% endif %}
{% endblock %}
